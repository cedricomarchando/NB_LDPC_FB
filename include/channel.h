
#ifndef CHANNEL_H_INCLUDED
#define CHANNEL_H_INCLUDED

/*!
 * \file channel.h
 * \brief header for channel functions
 */

#include "./struct.h"
#include "./init.h"

#define SQR(A) ((A)*(A))   //calcule le carré d'un nombre
#define BPSK(x) (1-2*(x))  // modulation BPSK
#define PI 3.1415926536

void ModelChannel_AWGN_BPSK (code_t *code, decoder_t *decoder, table_t *table,  int **NBIN, float EbN, int *init_rand);

void ModelChannel_AWGN_BPSK_repeat (code_t *code, decoder_t *decoder, table_t *table, int **NBIN, float EbN,int *init_rand);

void ModelChannel_AWGN_64 (code_t *code, decoder_t *decoder, int **NBIN, float EbN, int *init_rand);

void ModelChannel(code_t *code, decoder_t *decoder, int **NBIN, float EbN, int *init_rand);

void ModelChannel_AWGN_256QAM_4D (code_t *code, decoder_t *decoder, int **NBIN, float EbN, int *init_rand);

void build_QAM_table(int logGF);



/* //construction of pos_gf_to_bin
FILE *opfile;
opfile=fopen("./data/gf256_to_bin.txt","a");
int j;
 for(i=0;i<256;i++)
 {
     som=0;
     for(j=0; j<8;j++)
     {
     som= som+ BinGF_256[i][j]*pow(2,j);
     }
     fprintf(opfile, "%d, ",som );
     printf( " %d, %d \n ",som, pos_gf256_to_bin[i] );
     if (som != pos_gf256_to_bin[i] ) {printf("error!");};
 }
 fclose(opfile);
 getchar();
*/
static const int pos_gf16_to_bin[16]={0,1,2,4,8,3,6,12,11,5,10,7,14,15,13,9};
static const int pos_gf64_to_bin[64]={0, 1, 2, 4, 8, 16, 32, 3, 6, 12, 24, 48, 35, 5, 10, 20, 40, 19, 38, 15, 30, 60, 59, 53, 41, 17, 34, 7, 14, 28, 56, 51, 37, 9, 18, 36, 11, 22, 44, 27, 54, 47, 29, 58, 55, 45, 25, 50, 39, 13, 26, 52, 43, 21, 42, 23, 46, 31, 62, 63, 61, 57, 49, 33};
static const int pos_gf256_to_bin[256]={0, 1, 2, 4, 8, 16, 32, 64, 128, 29, 58, 116, 232, 205, 135, 19, 38, 76, 152, 45, 90, 180, 117, 234, 201, 143, 3, 6, 12, 24, 48, 96, 192, 157, 39, 78, 156, 37, 74, 148, 53, 106, 212, 181, 119, 238, 193, 159, 35, 70, 140, 5, 10, 20, 40, 80, 160, 93, 186, 105, 210, 185, 111, 222, 161, 95, 190, 97, 194, 153, 47, 94, 188, 101, 202, 137, 15, 30, 60, 120, 240, 253, 231, 211, 187, 107, 214, 177, 127, 254, 225, 223, 163, 91, 182, 113, 226, 217, 175, 67, 134, 17, 34, 68, 136, 13, 26, 52, 104, 208, 189, 103, 206, 129, 31, 62, 124, 248, 237, 199, 147, 59, 118, 236, 197, 151, 51, 102, 204, 133, 23, 46, 92, 184, 109, 218, 169, 79, 158, 33, 66, 132, 21, 42, 84, 168, 77, 154, 41, 82, 164, 85, 170, 73, 146, 57, 114, 228, 213, 183, 115, 230, 209, 191, 99, 198, 145, 63, 126, 252, 229, 215, 179, 123, 246, 241, 255, 227, 219, 171, 75, 150, 49, 98, 196, 149, 55, 110, 220, 165, 87, 174, 65, 130, 25, 50, 100, 200, 141, 7, 14, 28, 56, 112, 224, 221, 167, 83, 166, 81, 162, 89, 178, 121, 242, 249, 239, 195, 155, 43, 86, 172, 69, 138, 9, 18, 36, 72, 144, 61, 122, 244, 245, 247, 243, 251, 235, 203, 139, 11, 22, 44, 88, 176, 125, 250, 233, 207, 131, 27, 54, 108, 216, 173, 71, 142};



// from DVB-T2 mapping; bit ordering: y0, y1, y2 ...; coordinate: reel, imaginary.
static const float table_QPSK[16][2]=
{

{1  , 1},
{-1  , 1},
{1 , -1},
{-1  , -1}

};


static const float table_16QAM[16][2]=
{


{3  ,  3},
{-3  , 3 },
{3  , -3},
{-3  ,-3  },

{ 1 , 3 },
{ -1 , 3 },
{  1, -3 },
{ -1 , -3},

{ 3 , 1 },
{ -3 , 1 },
{ 3 , -1 },
{ -3 , -1 },

{ 1 , 1 },
{ -1 , 1 },
{ 1 , -1 },
{ -1 , -1}

};


static const float table_64QAM[64][2]=
{
{7, 7},
 {-7, 7},
 {7, -7},
 {-7, -7},
 {1, 7},
 {-1, 7},
 {1, -7},
 {-1, -7},
 {7, 1},
 {-7, 1},
 {7, -1},
 {-7, -1},
 {1, 1},
 {-1, 1},
 {1, -1},
 {-1, -1},
 {5, 7},
 {-5, 7},
 {5, -7},
 {-5, -7},
 {3, 7},
 {-3, 7},
 {3, -7},
 {-3, -7},
 {5, 1},
 {-5, 1},
 {5, -1},
 {-5, -1},
 {3, 1},
 {-3, 1},
 {3, -1},
 {-3, -1},
 {7, 5},
 {-7, 5},
 {7, -5},
 {-7, -5},
 {1, 5},
 {-1, 5},
 {1, -5},
 {-1, -5},
 {7, 3},
 {-7, 3},
 {7, -3},
 {-7, -3},
 {1, 3},
 {-1, 3},
 {1, -3},
 {-1, -3},
 {5, 5},
 {-5, 5},
 {5, -5},
 {-5, -5},
 {3, 5},
 {-3, 5},
 {3, -5},
 {-3, -5},
 {5, 3},
 {-5, 3},
 {5, -3},
 {-5, -3},
 {3, 3},
 {-3, 3},
 {3, -3},
 {-3, -3}

};



static const float table_256QAM[256][2]=
 {
 {15,  15},
{-15,  15},
{15,  -15},
{-15,  -15},
{1,  15},
{-1,  15},
{1,  -15},
{-1,  -15},
{15,  1},
{-15,  1},
{15,  -1},
{-15,  -1},
{1,  1},
{-1,  1},
{1,  -1},
{-1,  -1},
{9,  15},
{-9,  15},
{9,  -15},
{-9,  -15},
{7,  15},
{-7,  15},
{7,  -15},
{-7,  -15},
{9,  1},
{-9,  1},
{9,  -1},
{-9,  -1},
{7,  1},
{-7,  1},
{7,  -1},
{-7,  -1},
{15,  9},
{-15,  9},
{15,  -9},
{-15,  -9},
{1,  9},
{-1,  9},
{1,  -9},
{-1,  -9},
{15,  7},
{-15,  7},
{15,  -7},
{-15,  -7},
{1,  7},
{-1,  7},
{1,  -7},
{-1,  -7},
{9,  9},
{-9,  9},
{9,  -9},
{-9,  -9},
{7,  9},
{-7,  9},
{7,  -9},
{-7,  -9},
{9,  7},
{-9,  7},
{9,  -7},
{-9,  -7},
{7,  7},
{-7,  7},
{7,  -7},
{-7,  -7},
{13,  15},
{-13,  15},
{13,  -15},
{-13,  -15},
{3,  15},
{-3,  15},
{3,  -15},
{-3,  -15},
{13,  1},
{-13,  1},
{13,  -1},
{-13,  -1},
{3,  1},
{-3,  1},
{3,  -1},
{-3,  -1},
{11,  15},
{-11,  15},
{11,  -15},
{-11,  -15},
{5,  15},
{-5,  15},
{5,  -15},
{-5,  -15},
{11,  1},
{-11,  1},
{11,  -1},
{-11,  -1},
{5,  1},
{-5,  1},
{5,  -1},
{-5,  -1},
{13,  9},
{-13,  9},
{13,  -9},
{-13,  -9},
{3,  9},
{-3,  9},
{3,  -9},
{-3,  -9},
{13,  7},
{-13,  7},
{13,  -7},
{-13,  -7},
{3,  7},
{-3,  7},
{3,  -7},
{-3,  -7},
{11,  9},
{-11,  9},
{11,  -9},
{-11,  -9},
{5,  9},
{-5,  9},
{5,  -9},
{-5,  -9},
{11,  7},
{-11,  7},
{11,  -7},
{-11,  -7},
{5,  7},
{-5,  7},
{5,  -7},
{-5,  -7},
{15,  13},
{-15,  13},
{15,  -13},
{-15,  -13},
{1,  13},
{-1,  13},
{1,  -13},
{-1,  -13},
{15,  3},
{-15,  3},
{15,  -3},
{-15,  -3},
{1,  3},
{-1,  3},
{1,  -3},
{-1,  -3},
{9,  13},
{-9,  13},
{9,  -13},
{-9,  -13},
{7,  13},
{-7,  13},
{7,  -13},
{-7,  -13},
{9,  3},
{-9,  3},
{9,  -3},
{-9,  -3},
{7,  3},
{-7,  3},
{7,  -3},
{-7,  -3},
{15,  11},
{-15,  11},
{15,  -11},
{-15,  -11},
{1,  11},
{-1,  11},
{1,  -11},
{-1,  -11},
{15,  5},
{-15,  5},
{15,  -5},
{-15,  -5},
{1,  5},
{-1,  5},
{1,  -5},
{-1,  -5},
{9,  11},
{-9,  11},
{9,  -11},
{-9,  -11},
{7,  11},
{-7,  11},
{7,  -11},
{-7,  -11},
{9,  5},
{-9,  5},
{9,  -5},
{-9,  -5},
{7,  5},
{-7,  5},
{7,  -5},
{-7,  -5},
{13,  13},
{-13,  13},
{13,  -13},
{-13,  -13},
{3,  13},
{-3,  13},
{3,  -13},
{-3,  -13},
{13,  3},
{-13,  3},
{13,  -3},
{-13,  -3},
{3,  3},
{-3,  3},
{3,  -3},
{-3,  -3},
{11,  13},
{-11,  13},
{11,  -13},
{-11,  -13},
{5,  13},
{-5,  13},
{5,  -13},
{-5,  -13},
{11,  3},
{-11,  3},
{11,  -3},
{-11,  -3},
{5,  3},
{-5,  3},
{5,  -3},
{-5,  -3},
{13,  11},
{-13,  11},
{13,  -11},
{-13,  -11},
{3,  11},
{-3,  11},
{3,  -11},
{-3,  -11},
{13,  5},
{-13,  5},
{13,  -5},
{-13,  -5},
{3,  5},
{-3,  5},
{3,  -5},
{-3,  -5},
{11,  11},
{-11,  11},
{11,  -11},
{-11,  -11},
{5,  11},
{-5,  11},
{5,  -11},
{-5,  -11},
{11,  5},
{-11,  5},
{11,  -5},
{-11,  -5},
{5,  5},
{-5,  5},
{5,  -5},
{-5,  -5}
};


static const float table_256QAM_4D[256][4]=
{
  {  0.00000, 0.00000, 0.00000, 0.00000},
{-1.00000, -1.00000, -1.00000, -1.00000},
{1.00000, 1.00000, 1.00000, 1.00000},
{1.41421, -1.41421, 1.41421, -1.41421},
{0.76537, -1.84776, -0.76537, 1.84776},
{-1.84776, -0.76537, 1.84776, 0.76537},
{1.84776, 0.76537, -1.84776, -0.76537},
{-0.76537, 1.84776, 0.76537, -1.84776},
{-1.41421, 1.41421, -1.41421, 1.41421},
{-0.23463, -2.84776, -1.76537, 0.84776},
{0.23463, 2.84776, 1.76537, -0.84776},
{0.41421, -2.41421, 0.41421, -2.41421},
{-2.84776, -1.76537, 0.84776, -0.23463},
{2.41421, -0.41421, 2.41421, -0.41421},
{0.84776, -0.23463, -2.84776, -1.76537},
{-1.76537, 0.84776, -0.23463, -2.84776},
{1.76537, -0.84776, 0.23463, 2.84776},
{-0.84776, 0.23463, 2.84776, 1.76537},
{-2.41421, 0.41421, -2.41421, 0.41421},
{2.84776, 1.76537, -0.84776, 0.23463},
{-0.41421, 2.41421, -0.41421, 2.41421},
{2.61313, -1.08239, -2.61313, 1.08239},
{-2.61313, 1.08239, 2.61313, -1.08239},
{-0.43355, -2.17958, 3.26197, -0.64885},
{3.26197, -0.64885, -0.43355, -2.17958},
{0.64885, 0.43355, 2.17958, -3.26197},
{-0.64885, -0.43355, -2.17958, 3.26197},
{-3.26197, 0.64885, 0.43355, 2.17958},
{0.43355, 2.17958, -3.26197, 0.64885},
{2.17958, -3.26197, 0.64885, 0.43355},
{-2.17958, 3.26197, -0.64885, -0.43355},
{-2.00000, -2.00000, -2.00000, -2.00000},
{-1.08239, -2.61313, 1.08239, 2.61313},
{1.08239, 2.61313, -1.08239, -2.61313},
{2.00000, 2.00000, 2.00000, 2.00000},
{1.61313, -2.08239, -3.61313, 0.08239},
{-3.61313, 0.08239, 1.61313, -2.08239},
{3.61313, -0.08239, -1.61313, 2.08239},
{-1.61313, 2.08239, 3.61313, -0.08239},
{3.17958, -2.26197, 1.64885, 1.43355},
{0.56645, -1.17958, 4.26197, 0.35115},
{4.26197, 0.35115, 0.56645, -1.17958},
{-4.26197, -0.35115, -0.56645, 1.17958},
{-0.56645, 1.17958, -4.26197, -0.35115},
{-3.17958, 2.26197, -1.64885, -1.43355},
{-1.43355, -3.17958, 2.26197, -1.64885},
{2.26197, -1.64885, -1.43355, -3.17958},
{-2.08239, -3.61313, 0.08239, 1.61313},
{1.64885, 1.43355, 3.17958, -2.26197},
{0.08239, 1.61313, -2.08239, -3.61313},
{-0.08239, -1.61313, 2.08239, 3.61313},
{-1.64885, -1.43355, -3.17958, 2.26197},
{2.08239, 3.61313, -0.08239, -1.61313},
{-2.26197, 1.64885, 1.43355, 3.17958},
{1.43355, 3.17958, -2.26197, 1.64885},
{1.17958, -4.26197, -0.35115, -0.56645},
{-0.35115, -0.56645, 1.17958, -4.26197},
{0.35115, 0.56645, -1.17958, 4.26197},
{-1.17958, 4.26197, 0.35115, 0.56645},
{4.02734, -2.49661, -1.19891, -0.33182},
{-1.19891, -0.33182, 4.02734, -2.49661},
{1.19891, 0.33182, -4.02734, 2.49661},
{-4.02734, 2.49661, 1.19891, 0.33182},
{0.33182, -4.02734, 2.49661, 1.19891},
{-1.23463, -3.84776, -2.76537, -0.15224},
{-3.84776, -2.76537, -0.15224, -1.23463},
{-0.15224, -1.23463, -3.84776, -2.76537},
{2.49661, 1.19891, 0.33182, -4.02734},
{-2.49661, -1.19891, -0.33182, 4.02734},
{0.15224, 1.23463, 3.84776, 2.76537},
{3.84776, 2.76537, 0.15224, 1.23463},
{1.23463, 3.84776, 2.76537, 0.15224},
{-0.33182, 4.02734, -2.49661, -1.19891},
{-0.58579, -3.41421, -0.58579, -3.41421},
{-2.76537, -0.15224, -1.23463, -3.84776},
{-3.41421, -0.58579, -3.41421, -0.58579},
{3.41421, 0.58579, 3.41421, 0.58579},
{2.76537, 0.15224, 1.23463, 3.84776},
{0.58579, 3.41421, 0.58579, 3.41421},
{3.02734, -3.49661, -2.19891, -1.33182},
{-3.02734, 3.49661, 2.19891, 1.33182},
{-2.19891, -1.33182, 3.02734, -3.49661},
{2.19891, 1.33182, -3.02734, 3.49661},
{1.33182, -3.02734, 3.49661, 2.19891},
{5.02734, -1.49661, -0.19891, 0.66818},
{-0.19891, 0.66818, 5.02734, -1.49661},
{3.49661, 2.19891, 1.33182, -3.02734},
{-3.49661, -2.19891, -1.33182, 3.02734},
{0.19891, -0.66818, -5.02734, 1.49661},
{-5.02734, 1.49661, 0.19891, -0.66818},
{-1.33182, 3.02734, -3.49661, -2.19891},
{-0.66818, -5.02734, 1.49661, 0.19891},
{1.49661, 0.19891, -0.66818, -5.02734},
{-1.49661, -0.19891, 0.66818, 5.02734},
{0.66818, 5.02734, -1.49661, -0.19891},
{-4.61313, -0.91761, 0.61313, -3.08239},
{4.61313, 0.91761, -0.61313, 3.08239},
{0.61313, -3.08239, -4.61313, -0.91761},
{-0.61313, 3.08239, 4.61313, 0.91761},
{-5.26197, -1.35115, -1.56645, 0.17958},
{5.26197, 1.35115, 1.56645, -0.17958},
{1.56645, -0.17958, 5.26197, 1.35115},
{-1.56645, 0.17958, -5.26197, -1.35115},
{0.17958, -5.26197, -1.35115, -1.56645},
{-2.43355, -4.17958, 1.26197, -2.64885},
{2.82843, -2.82843, 2.82843, -2.82843},
{1.26197, -2.64885, -2.43355, -4.17958},
{-1.35115, -1.56645, 0.17958, -5.26197},
{1.53073, -3.69552, -1.53073, 3.69552},
{-2.64885, -2.43355, -4.17958, 1.26197},
{4.17958, -1.26197, 2.64885, 2.43355},
{-3.69552, -1.53073, 3.69552, 1.53073},
{3.69552, 1.53073, -3.69552, -1.53073},
{-4.17958, 1.26197, -2.64885, -2.43355},
{2.64885, 2.43355, 4.17958, -1.26197},
{-1.53073, 3.69552, 1.53073, -3.69552},
{1.35115, 1.56645, -0.17958, 5.26197},
{-1.26197, 2.64885, 2.43355, 4.17958},
{-2.82843, 2.82843, -2.82843, 2.82843},
{2.43355, 4.17958, -1.26197, 2.64885},
{-0.17958, 5.26197, 1.35115, 1.56645},
{-3.08239, -4.61313, -0.91761, 0.61313},
{-0.91761, 0.61313, -3.08239, -4.61313},
{0.91761, -0.61313, 3.08239, 4.61313},
{3.08239, 4.61313, 0.91761, -0.61313},
{0.53073, -4.69552, -2.53073, 2.69552},
{-4.69552, -2.53073, 2.69552, 0.53073},
{4.69552, 2.53073, -2.69552, -0.53073},
{-0.53073, 4.69552, 2.53073, -2.69552},
{1.82843, -3.82843, 1.82843, -3.82843},
{-3.00000, -3.00000, -3.00000, -3.00000},
{3.82843, -1.82843, 3.82843, -1.82843},
{2.69552, 0.53073, -4.69552, -2.53073},
{-2.53073, 2.69552, 0.53073, -4.69552},
{2.53073, -2.69552, -0.53073, 4.69552},
{-2.69552, -0.53073, 4.69552, 2.53073},
{-3.82843, 1.82843, -3.82843, 1.82843},
{3.00000, 3.00000, 3.00000, 3.00000},
{-1.82843, 3.82843, -1.82843, 3.82843},
{3.37849, -2.93015, -3.37849, 2.93015},
{-3.37849, 2.93015, 3.37849, -2.93015},
{4.46088, -0.31703, -4.46088, 0.31703},
{-4.46088, 0.31703, 4.46088, -0.31703},
{2.02734, -4.49661, -3.19891, -2.33182},
{-3.19891, -2.33182, 2.02734, -4.49661},
{2.33182, -2.02734, 4.49661, 3.19891},
{-2.33182, 2.02734, -4.49661, -3.19891},
{3.19891, 2.33182, -2.02734, 4.49661},
{-2.02734, 4.49661, 3.19891, 2.33182},
{-4.49661, -3.19891, -2.33182, 2.02734},
{-0.80109, -1.66818, -6.02734, 0.49661},
{6.02734, -0.49661, 0.80109, 1.66818},
{-6.02734, 0.49661, -0.80109, -1.66818},
{0.80109, 1.66818, 6.02734, -0.49661},
{4.49661, 3.19891, 2.33182, -2.02734},
{-1.66818, -6.02734, 0.49661, -0.80109},
{3.59379, -4.67619, 2.06306, -0.98067},
{0.98067, -3.59379, 4.67619, -2.06306},
{4.67619, -2.06306, 0.98067, -3.59379},
{2.06306, -0.98067, 3.59379, -4.67619},
{0.49661, -0.80109, -1.66818, -6.02734},
{2.94495, -5.10973, -0.11652, 2.28130},
{-2.28130, -2.94495, 5.10973, 0.11652},
{5.10973, 0.11652, -2.28130, -2.94495},
{-0.11652, 2.28130, 2.94495, -5.10973},
{-0.31703, -4.46088, 0.31703, 4.46088},
{-2.93015, -3.37849, 2.93015, 3.37849},
{2.93015, 3.37849, -2.93015, -3.37849},
{0.31703, 4.46088, -0.31703, -4.46088},
{0.11652, -2.28130, -2.94495, 5.10973},
{-5.10973, -0.11652, 2.28130, 2.94495},
{2.28130, 2.94495, -5.10973, -0.11652},
{-2.94495, 5.10973, 0.11652, -2.28130},
{-0.49661, 0.80109, 1.66818, 6.02734},
{-2.06306, 0.98067, -3.59379, 4.67619},
{-4.67619, 2.06306, -0.98067, 3.59379},
{-0.98067, 3.59379, -4.67619, 2.06306},
{-3.59379, 4.67619, -2.06306, 0.98067},
{1.66818, 6.02734, -0.49661, 0.80109},
{2.37849, -3.93015, -4.37849, 1.93015},
{-4.37849, 1.93015, 2.37849, -3.93015},
{4.37849, -1.93015, -2.37849, 3.93015},
{-2.37849, 3.93015, 4.37849, -1.93015},
{3.46088, -1.31703, -5.46088, -0.68297},
{-3.46088, 1.31703, 5.46088, 0.68297},
{-5.46088, -0.68297, 3.46088, -1.31703},
{5.46088, 0.68297, -3.46088, 1.31703},
{-1.58579, -4.41421, -1.58579, -4.41421},
{-3.28130, -3.94495, 4.10973, -0.88348},
{4.10973, -0.88348, -3.28130, -3.94495},
{-4.10973, 0.88348, 3.28130, 3.94495},
{3.28130, 3.94495, -4.10973, 0.88348},
{1.58579, 4.41421, 1.58579, 4.41421},
{-0.01933, -4.59379, 3.67619, -3.06306},
{3.67619, -3.06306, -0.01933, -4.59379},
{1.94495, -6.10973, -1.11652, 1.28130},
{-2.23463, -4.84776, -3.76537, -1.15224},
{4.59379, -3.67619, 3.06306, 0.01933},
{-4.84776, -3.76537, -1.15224, -2.23463},
{-1.15224, -2.23463, -4.84776, -3.76537},
{5.67619, -1.06306, 1.98067, -2.59379},
{-3.76537, -1.15224, -2.23463, -4.84776},
{3.06306, 0.01933, 4.59379, -3.67619},
{-1.11652, 1.28130, 1.94495, -6.10973},
{-1.31703, -5.46088, -0.68297, 3.46088},
{-1.28130, -1.94495, 6.10973, 1.11652},
{-4.41421, -1.58579, -4.41421, -1.58579},
{6.10973, 1.11652, -1.28130, -1.94495},
{0.88348, 3.28130, 3.94495, -4.10973},
{-0.68297, 3.46088, -1.31703, -5.46088},
{0.68297, -3.46088, 1.31703, 5.46088},
{-0.88348, -3.28130, -3.94495, 4.10973},
{-6.10973, -1.11652, 1.28130, 1.94495},
{4.41421, 1.58579, 4.41421, 1.58579},
{1.28130, 1.94495, -6.10973, -1.11652},
{1.31703, 5.46088, 0.68297, -3.46088},
{1.11652, -1.28130, -1.94495, 6.10973},
{-3.06306, -0.01933, -4.59379, 3.67619},
{3.76537, 1.15224, 2.23463, 4.84776},
{-5.67619, 1.06306, -1.98067, 2.59379},
{1.15224, 2.23463, 4.84776, 3.76537},
{4.84776, 3.76537, 1.15224, 2.23463},
{-4.59379, 3.67619, -3.06306, -0.01933},
{2.23463, 4.84776, 3.76537, 1.15224},
{-1.94495, 6.10973, 1.11652, -1.28130},
{-3.67619, 3.06306, 0.01933, 4.59379},
{0.01933, 4.59379, -3.67619, 3.06306},
{1.98067, -2.59379, 5.67619, -1.06306},
{3.94495, -4.10973, 0.88348, 3.28130},
{-3.93015, -4.37849, 1.93015, 2.37849},
{1.93015, 2.37849, -3.93015, -4.37849},
{-1.93015, -2.37849, 3.93015, 4.37849},
{3.93015, 4.37849, -1.93015, -2.37849},
{-3.94495, 4.10973, -0.88348, -3.28130},
{-1.98067, 2.59379, -5.67619, 1.06306},
{2.59379, -5.67619, 1.06306, -1.98067},
{1.06306, -1.98067, 2.59379, -5.67619},
{-1.06306, 1.98067, -2.59379, 5.67619},
{-2.59379, 5.67619, -1.06306, 1.98067},
{-1.96428, 1.51594, 4.79271, -4.34436},
{1.96428, -1.51594, -4.79271, 4.34436},
{4.79271, -4.34436, -1.96428, 1.51594},
{-4.79271, 4.34436, 1.96428, -1.51594},
{5.44155, -3.91082, 0.21530, -1.74603},
{-5.44155, 3.91082, -0.21530, 1.74603},
{0.21530, -1.74603, 5.44155, -3.91082},
{5.87510, -1.73124, -3.04667, -1.09719},
{-3.04667, -1.09719, 5.87510, -1.73124},
{3.04667, 1.09719, -5.87510, 1.73124},
{-5.87510, 1.73124, 3.04667, 1.09719},
{-0.21530, 1.74603, -5.44155, 3.91082},
{1.09719, -5.87510, 1.73124, 3.04667},
{-0.46927, -5.69552, -3.53073, 1.69552},
{1.73124, 3.04667, 1.09719, -5.87510},
{-1.73124, -3.04667, -1.09719, 5.87510},
{0.46927, 5.69552, 3.53073, -1.69552}
};


static const float table_256QAM_4D_16QAM_R[256][4]=
{
  {  -2.4272,   -2.0270,   -4.1288,   -0.9760},
{-0.7256,   -3.0779,   -4.1288,   -0.9760},
{0.9760,   -4.1288,   -4.1288,   -0.9760},
{-3.0779,    0.7256,   -4.1288,   -0.9760},
{-1.3763,   -0.3253,   -4.1288,   -0.9760},
{0.3253,   -1.3763,   -4.1288,   -0.9760},
{2.0270,   -2.4272,   -4.1288,   -0.9760},
{-2.0270,    2.4272,   -4.1288,   -0.9760},
{-0.3253,    1.3763,   -4.1288,   -0.9760},
{1.3763,    0.3253,   -4.1288,   -0.9760},
{3.0779,   -0.7256,   -4.1288,   -0.9760},
{-0.9760,    4.1288,   -4.1288,   -0.9760},
{0.7256,    3.0779,   -4.1288,   -0.9760},
{2.4272,    2.0270,   -4.1288,   -0.9760},
{4.1288,    0.9760,   -4.1288,   -0.9760},
{-4.1288,   -0.9760,   -4.1288,   -0.9760},
{-2.4272,   -2.0270,   -2.4272,   -2.0270},
{-0.7256,   -3.0779,   -2.4272,   -2.0270},
{0.9760,   -4.1288,   -2.4272,   -2.0270},
{-3.0779,    0.7256,   -2.4272,   -2.0270},
{-1.3763,   -0.3253,   -2.4272,   -2.0270},
{0.3253,   -1.3763,   -2.4272,   -2.0270},
{2.0270,   -2.4272,   -2.4272,   -2.0270},
{-2.0270,    2.4272,   -2.4272,   -2.0270},
{-0.3253,    1.3763,   -2.4272,   -2.0270},
{1.3763,    0.3253,   -2.4272,   -2.0270},
{3.0779,   -0.7256,   -2.4272,   -2.0270},
{-0.9760,    4.1288,   -2.4272,   -2.0270},
{0.7256,    3.0779,   -2.4272,   -2.0270},
{2.4272,    2.0270,   -2.4272,   -2.0270},
{4.1288,    0.9760,   -2.4272,   -2.0270},
{-4.1288,   -0.9760,   -2.4272,   -2.0270},
{-2.4272,   -2.0270,   -0.7256,   -3.0779},
{-0.7256,   -3.0779,   -0.7256,   -3.0779},
{0.9760,   -4.1288,   -0.7256,   -3.0779},
{-3.0779,    0.7256,   -0.7256,   -3.0779},
{-1.3763,   -0.3253,   -0.7256,   -3.0779},
{0.3253,   -1.3763,   -0.7256,   -3.0779},
{2.0270,   -2.4272,   -0.7256,   -3.0779},
{-2.0270,    2.4272,   -0.7256,   -3.0779},
{-0.3253,    1.3763,   -0.7256,   -3.0779},
{1.3763,    0.3253,   -0.7256,   -3.0779},
{3.0779,   -0.7256,   -0.7256,   -3.0779},
{-0.9760,    4.1288,   -0.7256,   -3.0779},
{0.7256,    3.0779,   -0.7256,   -3.0779},
{2.4272,    2.0270,   -0.7256,   -3.0779},
{4.1288,    0.9760,   -0.7256,   -3.0779},
{-4.1288,   -0.9760,   -0.7256,   -3.0779},
{-2.4272,   -2.0270,    0.9760,   -4.1288},
{-0.7256,   -3.0779,    0.9760,   -4.1288},
{0.9760,   -4.1288,    0.9760,   -4.1288},
{-3.0779,    0.7256,    0.9760,   -4.1288},
{-1.3763,   -0.3253,    0.9760,   -4.1288},
{0.3253,   -1.3763,    0.9760,   -4.1288},
{2.0270,   -2.4272,    0.9760,   -4.1288},
{-2.0270,    2.4272,    0.9760,   -4.1288},
{-0.3253,    1.3763,    0.9760,   -4.1288},
{1.3763,    0.3253,    0.9760,   -4.1288},
{3.0779,   -0.7256,    0.9760,   -4.1288},
{-0.9760,    4.1288,    0.9760,   -4.1288},
{0.7256,    3.0779,    0.9760,   -4.1288},
{2.4272,    2.0270,    0.9760,   -4.1288},
{4.1288,    0.9760,    0.9760,   -4.1288},
{-4.1288,   -0.9760,    0.9760,   -4.1288},
{-2.4272,   -2.0270,   -3.0779,    0.7256},
{-0.7256,   -3.0779,   -3.0779,    0.7256},
{0.9760,   -4.1288,   -3.0779,    0.7256},
{-3.0779,    0.7256,   -3.0779,    0.7256},
{-1.3763,   -0.3253,   -3.0779,    0.7256},
{0.3253,   -1.3763,   -3.0779,    0.7256},
{2.0270,   -2.4272,   -3.0779,    0.7256},
{-2.0270,    2.4272,   -3.0779,    0.7256},
{-0.3253,    1.3763,   -3.0779,    0.7256},
{1.3763,    0.3253,   -3.0779,    0.7256},
{3.0779,   -0.7256,   -3.0779,    0.7256},
{-0.9760,    4.1288,   -3.0779,    0.7256},
{0.7256,    3.0779,   -3.0779,    0.7256},
{2.4272,    2.0270,   -3.0779,    0.7256},
{4.1288,    0.9760,   -3.0779,    0.7256},
{-4.1288,   -0.9760,   -3.0779,    0.7256},
{-2.4272,   -2.0270,   -1.3763,   -0.3253},
{-0.7256,   -3.0779,   -1.3763,   -0.3253},
{0.9760,   -4.1288,   -1.3763,   -0.3253},
{-3.0779,    0.7256,   -1.3763,   -0.3253},
{-1.3763,   -0.3253,   -1.3763,   -0.3253},
{0.3253,   -1.3763,   -1.3763,   -0.3253},
{2.0270,   -2.4272,   -1.3763,   -0.3253},
{-2.0270,    2.4272,   -1.3763,   -0.3253},
{-0.3253,    1.3763,   -1.3763,   -0.3253},
{1.3763,    0.3253,   -1.3763,   -0.3253},
{3.0779,   -0.7256,   -1.3763,   -0.3253},
{-0.9760,    4.1288,   -1.3763,   -0.3253},
{0.7256,    3.0779,   -1.3763,   -0.3253},
{2.4272,    2.0270,   -1.3763,   -0.3253},
{4.1288,    0.9760,   -1.3763,   -0.3253},
{-4.1288,   -0.9760,   -1.3763,   -0.3253},
{-2.4272,   -2.0270,    0.3253,   -1.3763},
{-0.7256,   -3.0779,    0.3253,   -1.3763},
{0.9760,   -4.1288,    0.3253,   -1.3763},
{-3.0779,    0.7256,    0.3253,   -1.3763},
{-1.3763,   -0.3253,    0.3253,   -1.3763},
{0.3253,   -1.3763,    0.3253,   -1.3763},
{2.0270,   -2.4272,    0.3253,   -1.3763},
{-2.0270,    2.4272,    0.3253,   -1.3763},
{-0.3253,    1.3763,    0.3253,   -1.3763},
{1.3763,    0.3253,    0.3253,   -1.3763},
{3.0779,   -0.7256,    0.3253,   -1.3763},
{-0.9760,    4.1288,    0.3253,   -1.3763},
{0.7256,    3.0779,    0.3253,   -1.3763},
{2.4272,    2.0270,    0.3253,   -1.3763},
{4.1288,    0.9760,    0.3253,   -1.3763},
{-4.1288,   -0.9760,    0.3253,   -1.3763},
{-2.4272,   -2.0270,    2.0270,   -2.4272},
{-0.7256,   -3.0779,    2.0270,   -2.4272},
{0.9760,   -4.1288,    2.0270,   -2.4272},
{-3.0779,    0.7256,    2.0270,   -2.4272},
{-1.3763,   -0.3253,    2.0270,   -2.4272},
{0.3253,   -1.3763,    2.0270,   -2.4272},
{2.0270,   -2.4272,    2.0270,   -2.4272},
{-2.0270,    2.4272,    2.0270,   -2.4272},
{-0.3253,    1.3763,    2.0270,   -2.4272},
{1.3763,    0.3253,    2.0270,   -2.4272},
{3.0779,   -0.7256,    2.0270,   -2.4272},
{-0.9760,    4.1288,    2.0270,   -2.4272},
{0.7256,    3.0779,    2.0270,   -2.4272},
{2.4272,    2.0270,    2.0270,   -2.4272},
{4.1288,    0.9760,    2.0270,   -2.4272},
{-4.1288,   -0.9760,    2.0270,   -2.4272},
{-2.4272,   -2.0270,   -2.0270,    2.4272},
{-0.7256,   -3.0779,   -2.0270,    2.4272},
{0.9760,   -4.1288,   -2.0270,    2.4272},
{-3.0779,    0.7256,   -2.0270,    2.4272},
{-1.3763,   -0.3253,   -2.0270,    2.4272},
{0.3253,   -1.3763,   -2.0270,    2.4272},
{2.0270,   -2.4272,   -2.0270,    2.4272},
{-2.0270,    2.4272,   -2.0270,    2.4272},
{-0.3253,    1.3763,   -2.0270,    2.4272},
{1.3763,    0.3253,   -2.0270,    2.4272},
{3.0779,   -0.7256,   -2.0270,    2.4272},
{-0.9760,    4.1288,   -2.0270,    2.4272},
{0.7256,    3.0779,   -2.0270,    2.4272},
{2.4272,    2.0270,   -2.0270,    2.4272},
{4.1288,    0.9760,   -2.0270,    2.4272},
{-4.1288,   -0.9760,   -2.0270,    2.4272},
{-2.4272,   -2.0270,   -0.3253,    1.3763},
{-0.7256,   -3.0779,   -0.3253,    1.3763},
{0.9760,   -4.1288,   -0.3253,    1.3763},
{-3.0779,    0.7256,   -0.3253,    1.3763},
{-1.3763,   -0.3253,   -0.3253,    1.3763},
{0.3253,   -1.3763,   -0.3253,    1.3763},
{2.0270,   -2.4272,   -0.3253,    1.3763},
{-2.0270,    2.4272,   -0.3253,    1.3763},
{-0.3253,    1.3763,   -0.3253,    1.3763},
{1.3763,    0.3253,   -0.3253,    1.3763},
{3.0779,   -0.7256,   -0.3253,    1.3763},
{-0.9760,    4.1288,   -0.3253,    1.3763},
{0.7256,    3.0779,   -0.3253,    1.3763},
{2.4272,    2.0270,   -0.3253,    1.3763},
{4.1288,    0.9760,   -0.3253,    1.3763},
{-4.1288,   -0.9760,   -0.3253,    1.3763},
{-2.4272,   -2.0270,    1.3763,    0.3253},
{-0.7256,   -3.0779,    1.3763,    0.3253},
{0.9760,   -4.1288,    1.3763,    0.3253},
{-3.0779,    0.7256,    1.3763,    0.3253},
{-1.3763,   -0.3253,    1.3763,    0.3253},
{0.3253,   -1.3763,    1.3763,    0.3253},
{2.0270,   -2.4272,    1.3763,    0.3253},
{-2.0270,    2.4272,    1.3763,    0.3253},
{-0.3253,    1.3763,    1.3763,    0.3253},
{1.3763,    0.3253,    1.3763,    0.3253},
{3.0779,   -0.7256,    1.3763,    0.3253},
{-0.9760,    4.1288,    1.3763,    0.3253},
{0.7256,    3.0779,    1.3763,    0.3253},
{2.4272,    2.0270,    1.3763,    0.3253},
{4.1288,    0.9760,    1.3763,    0.3253},
{-4.1288,   -0.9760,    1.3763,    0.3253},
{-2.4272,   -2.0270,    3.0779,   -0.7256},
{-0.7256,   -3.0779,    3.0779,   -0.7256},
{0.9760,   -4.1288,    3.0779,   -0.7256},
{-3.0779,    0.7256,    3.0779,   -0.7256},
{-1.3763,   -0.3253,    3.0779,   -0.7256},
{0.3253,   -1.3763,    3.0779,   -0.7256},
{2.0270,   -2.4272,    3.0779,   -0.7256},
{-2.0270,    2.4272,    3.0779,   -0.7256},
{-0.3253,    1.3763,    3.0779,   -0.7256},
{1.3763,    0.3253,    3.0779,   -0.7256},
{3.0779,   -0.7256,    3.0779,   -0.7256},
{-0.9760,    4.1288,    3.0779,   -0.7256},
{0.7256,    3.0779,    3.0779,   -0.7256},
{2.4272,    2.0270,    3.0779,   -0.7256},
{4.1288,    0.9760,    3.0779,   -0.7256},
{-4.1288,   -0.9760,    3.0779,   -0.7256},
{-2.4272,   -2.0270,   -0.9760,    4.1288},
{-0.7256,   -3.0779,   -0.9760,    4.1288},
{0.9760,   -4.1288,   -0.9760,    4.1288},
{-3.0779,    0.7256,   -0.9760,    4.1288},
{-1.3763,   -0.3253,   -0.9760,    4.1288},
{0.3253,   -1.3763,   -0.9760,    4.1288},
{2.0270,   -2.4272,   -0.9760,    4.1288},
{-2.0270,    2.4272,   -0.9760,    4.1288},
{-0.3253,    1.3763,   -0.9760,    4.1288},
{1.3763,    0.3253,   -0.9760,    4.1288},
{3.0779,   -0.7256,   -0.9760,    4.1288},
{-0.9760,    4.1288,   -0.9760,    4.1288},
{0.7256,    3.0779,   -0.9760,    4.1288},
{2.4272,    2.0270,   -0.9760,    4.1288},
{4.1288,    0.9760,   -0.9760,    4.1288},
{-4.1288,   -0.9760,   -0.9760,    4.1288},
{-2.4272,   -2.0270,    0.7256,    3.0779},
{-0.7256,   -3.0779,    0.7256,    3.0779},
{0.9760,   -4.1288,    0.7256,    3.0779},
{-3.0779,    0.7256,    0.7256,    3.0779},
{-1.3763,   -0.3253,    0.7256,    3.0779},
{0.3253,   -1.3763,    0.7256,    3.0779},
{2.0270,   -2.4272,    0.7256,    3.0779},
{-2.0270,    2.4272,    0.7256,    3.0779},
{-0.3253,    1.3763,    0.7256,    3.0779},
{1.3763,    0.3253,    0.7256,    3.0779},
{3.0779,   -0.7256,    0.7256,    3.0779},
{-0.9760,    4.1288,    0.7256,    3.0779},
{0.7256,    3.0779,    0.7256,    3.0779},
{2.4272,    2.0270,    0.7256,    3.0779},
{4.1288,    0.9760,    0.7256,    3.0779},
{-4.1288,   -0.9760,    0.7256,    3.0779},
{-2.4272,   -2.0270,    2.4272,    2.0270},
{-0.7256,   -3.0779,    2.4272,    2.0270},
{0.9760,   -4.1288,    2.4272,    2.0270},
{-3.0779,    0.7256,    2.4272,    2.0270},
{-1.3763,   -0.3253,    2.4272,    2.0270},
{0.3253,   -1.3763,    2.4272,    2.0270},
{2.0270,   -2.4272,    2.4272,    2.0270},
{-2.0270,    2.4272,    2.4272,    2.0270},
{-0.3253,    1.3763,    2.4272,    2.0270},
{1.3763,    0.3253,    2.4272,    2.0270},
{3.0779,   -0.7256,    2.4272,    2.0270},
{-0.9760,    4.1288,    2.4272,    2.0270},
{0.7256,    3.0779,    2.4272,    2.0270},
{2.4272,    2.0270,    2.4272,    2.0270},
{4.1288,    0.9760,    2.4272,    2.0270},
{-4.1288,   -0.9760,    2.4272,    2.0270},
{-2.4272,   -2.0270,    4.1288,    0.9760},
{-0.7256,   -3.0779,    4.1288,    0.9760},
{0.9760,   -4.1288,    4.1288,    0.9760},
{-3.0779,    0.7256,    4.1288,    0.9760},
{-1.3763,   -0.3253,    4.1288,    0.9760},
{0.3253,   -1.3763,    4.1288,    0.9760},
{2.0270,   -2.4272,    4.1288,    0.9760},
{-2.0270,    2.4272,    4.1288,    0.9760},
{-0.3253,    1.3763,    4.1288,    0.9760},
{1.3763,    0.3253,    4.1288,    0.9760},
{3.0779,   -0.7256,    4.1288,    0.9760},
{-0.9760,    4.1288,    4.1288,    0.9760},
{0.7256,    3.0779,    4.1288,    0.9760},
{2.4272,    2.0270,    4.1288,    0.9760},
{4.1288,    0.9760,    4.1288,    0.9760},
{-4.1288,   -0.9760,    4.1288,    0.9760}
};

static const float table_256QAM_4D_16QAM[256][4]=
{
  {  -1,  -3,  -3,  -3},
{1,  -3,  -3,  -3},
{3,  -3,  -3,  -3},
{-3,  -1,  -3,  -3},
{-1,  -1,  -3,  -3},
{1,  -1,  -3,  -3},
{3,  -1,  -3,  -3},
{-3,   1,  -3,  -3},
{-1,   1,  -3,  -3},
{1,   1,  -3,  -3},
{3,   1,  -3,  -3},
{-3,   3,  -3,  -3},
{-1,   3,  -3,  -3},
{1,   3,  -3,  -3},
{3,   3,  -3,  -3},
{-3,  -3,  -3,  -3},
{-1,  -3,  -1,  -3},
{1,  -3,  -1,  -3},
{3,  -3,  -1,  -3},
{-3,  -1,  -1,  -3},
{-1,  -1,  -1,  -3},
{1,  -1,  -1,  -3},
{3,  -1,  -1,  -3},
{-3,   1,  -1,  -3},
{-1,   1,  -1,  -3},
{1,   1,  -1,  -3},
{3,   1,  -1,  -3},
{-3,   3,  -1,  -3},
{-1,   3,  -1,  -3},
{1,   3,  -1,  -3},
{3,   3,  -1,  -3},
{-3,  -3,  -1,  -3},
{-1,  -3,   1,  -3},
{1,  -3,   1,  -3},
{3,  -3,   1,  -3},
{-3,  -1,   1,  -3},
{-1,  -1,   1,  -3},
{1,  -1,   1,  -3},
{3,  -1,   1,  -3},
{-3,   1,   1,  -3},
{-1,   1,   1,  -3},
{1,   1,   1,  -3},
{3,   1,   1,  -3},
{-3,   3,   1,  -3},
{-1,   3,   1,  -3},
{1,   3,   1,  -3},
{3,   3,   1,  -3},
{-3,  -3,   1,  -3},
{-1,  -3,   3,  -3},
{1,  -3,   3,  -3},
{3,  -3,   3,  -3},
{-3,  -1,   3,  -3},
{-1,  -1,   3,  -3},
{1,  -1,   3,  -3},
{3,  -1,   3,  -3},
{-3,   1,   3,  -3},
{-1,   1,   3,  -3},
{1,   1,   3,  -3},
{3,   1,   3,  -3},
{-3,   3,   3,  -3},
{-1,   3,   3,  -3},
{1,   3,   3,  -3},
{3,   3,   3,  -3},
{-3,  -3,   3,  -3},
{-1,  -3,  -3,  -1},
{1,  -3,  -3,  -1},
{3,  -3,  -3,  -1},
{-3,  -1,  -3,  -1},
{-1,  -1,  -3,  -1},
{1,  -1,  -3,  -1},
{3,  -1,  -3,  -1},
{-3,   1,  -3,  -1},
{-1,   1,  -3,  -1},
{1,   1,  -3,  -1},
{3,   1,  -3,  -1},
{-3,   3,  -3,  -1},
{-1,   3,  -3,  -1},
{1,   3,  -3,  -1},
{3,   3,  -3,  -1},
{-3,  -3,  -3,  -1},
{-1,  -3,  -1,  -1},
{1,  -3,  -1,  -1},
{3,  -3,  -1,  -1},
{-3,  -1,  -1,  -1},
{-1,  -1,  -1,  -1},
{1,  -1,  -1,  -1},
{3,  -1,  -1,  -1},
{-3,   1,  -1,  -1},
{-1,   1,  -1,  -1},
{1,   1,  -1,  -1},
{3,   1,  -1,  -1},
{-3,   3,  -1,  -1},
{-1,   3,  -1,  -1},
{1,   3,  -1,  -1},
{3,   3,  -1,  -1},
{-3,  -3,  -1,  -1},
{-1,  -3,   1,  -1},
{1,  -3,   1,  -1},
{3,  -3,   1,  -1},
{-3,  -1,   1,  -1},
{-1,  -1,   1,  -1},
{1,  -1,   1,  -1},
{3,  -1,   1,  -1},
{-3,   1,   1,  -1},
{-1,   1,   1,  -1},
{1,   1,   1,  -1},
{3,   1,   1,  -1},
{-3,   3,   1,  -1},
{-1,   3,   1,  -1},
{1,   3,   1,  -1},
{3,   3,   1,  -1},
{-3,  -3,   1,  -1},
{-1,  -3,   3,  -1},
{1,  -3,   3,  -1},
{3,  -3,   3,  -1},
{-3,  -1,   3,  -1},
{-1,  -1,   3,  -1},
{1,  -1,   3,  -1},
{3,  -1,   3,  -1},
{-3,   1,   3,  -1},
{-1,   1,   3,  -1},
{1,   1,   3,  -1},
{3,   1,   3,  -1},
{-3,   3,   3,  -1},
{-1,   3,   3,  -1},
{1,   3,   3,  -1},
{3,   3,   3,  -1},
{-3,  -3,   3,  -1},
{-1,  -3,  -3,   1},
{1,  -3,  -3,   1},
{3,  -3,  -3,   1},
{-3,  -1,  -3,   1},
{-1,  -1,  -3,   1},
{1,  -1,  -3,   1},
{3,  -1,  -3,   1},
{-3,   1,  -3,   1},
{-1,   1,  -3,   1},
{1,   1,  -3,   1},
{3,   1,  -3,   1},
{-3,   3,  -3,   1},
{-1,   3,  -3,   1},
{1,   3,  -3,   1},
{3,   3,  -3,   1},
{-3,  -3,  -3,   1},
{-1,  -3,  -1,   1},
{1,  -3,  -1,   1},
{3,  -3,  -1,   1},
{-3,  -1,  -1,   1},
{-1,  -1,  -1,   1},
{1,  -1,  -1,   1},
{3,  -1,  -1,   1},
{-3,   1,  -1,   1},
{-1,   1,  -1,   1},
{1,   1,  -1,   1},
{3,   1,  -1,   1},
{-3,   3,  -1,   1},
{-1,   3,  -1,   1},
{1,   3,  -1,   1},
{3,   3,  -1,   1},
{-3,  -3,  -1,   1},
{-1,  -3,   1,   1},
{1,  -3,   1,   1},
{3,  -3,   1,   1},
{-3,  -1,   1,   1},
{-1,  -1,   1,   1},
{1,  -1,   1,   1},
{3,  -1,   1,   1},
{-3,   1,   1,   1},
{-1,   1,   1,   1},
{1,   1,   1,   1},
{3,   1,   1,   1},
{-3,   3,   1,   1},
{-1,   3,   1,   1},
{1,   3,   1,   1},
{3,   3,   1,   1},
{-3,  -3,   1,   1},
{-1,  -3,   3,   1},
{1,  -3,   3,   1},
{3,  -3,   3,   1},
{-3,  -1,   3,   1},
{-1,  -1,   3,   1},
{1,  -1,   3,   1},
{3,  -1,   3,   1},
{-3,   1,   3,   1},
{-1,   1,   3,   1},
{1,   1,   3,   1},
{3,   1,   3,   1},
{-3,   3,   3,   1},
{-1,   3,   3,   1},
{1,   3,   3,   1},
{3,   3,   3,   1},
{-3,  -3,   3,   1},
{-1,  -3,  -3,   3},
{1,  -3,  -3,   3},
{3,  -3,  -3,   3},
{-3,  -1,  -3,   3},
{-1,  -1,  -3,   3},
{1,  -1,  -3,   3},
{3,  -1,  -3,   3},
{-3,   1,  -3,   3},
{-1,   1,  -3,   3},
{1,   1,  -3,   3},
{3,   1,  -3,   3},
{-3,   3,  -3,   3},
{-1,   3,  -3,   3},
{1,   3,  -3,   3},
{3,   3,  -3,   3},
{-3,  -3,  -3,   3},
{-1,  -3,  -1,   3},
{1,  -3,  -1,   3},
{3,  -3,  -1,   3},
{-3,  -1,  -1,   3},
{-1,  -1,  -1,   3},
{1,  -1,  -1,   3},
{3,  -1,  -1,   3},
{-3,   1,  -1,   3},
{-1,   1,  -1,   3},
{1,   1,  -1,   3},
{3,   1,  -1,   3},
{-3,   3,  -1,   3},
{-1,   3,  -1,   3},
{1,   3,  -1,   3},
{3,   3,  -1,   3},
{-3,  -3,  -1,   3},
{-1,  -3,   1,   3},
{1,  -3,   1,   3},
{3,  -3,   1,   3},
{-3,  -1,   1,   3},
{-1,  -1,   1,   3},
{1,  -1,   1,   3},
{3,  -1,   1,   3},
{-3,   1,   1,   3},
{-1,   1,   1,   3},
{1,   1,   1,   3},
{3,   1,   1,   3},
{-3,   3,   1,   3},
{-1,   3,   1,   3},
{1,   3,   1,   3},
{3,   3,   1,   3},
{-3,  -3,   1,   3},
{-1,  -3,   3,   3},
{1,  -3,   3,   3},
{3,  -3,   3,   3},
{-3,  -1,   3,   3},
{-1,  -1,   3,   3},
{1,  -1,   3,   3},
{3,  -1,   3,   3},
{-3,   1,   3,   3},
{-1,   1,   3,   3},
{1,   1,   3,   3},
{3,   1,   3,   3},
{-3,   3,   3,   3},
{-1,   3,   3,   3},
{1,   3,   3,   3},
{3,   3,   3,   3},
{-3,  -3,   3,   3}
};


static const float table_256_circleQAM[256][2]=
{
   { -1, -1},
{-1, 1},
{1, -1},
{1, 1},
{-3, -1},
{-3, 1},
{-1, -3},
{-1, 3},
{1, -3},
{1, 3},
{3, -1},
{3, 1},
{-3, -3},
{-3, 3},
{3, -3},
{3, 3},
{-5, -1},
{-5, 1},
{-1, -5},
{-1, 5},
{1, -5},
{1, 5},
{5, -1},
{5, 1},
{-5, -3},
{-5, 3},
{-3, -5},
{-3, 5},
{3, -5},
{3, 5},
{5, -3},
{5, 3},
{-7, -1},
{-7, 1},
{-5, -5},
{-5, 5},
{-1, -7},
{-1, 7},
{1, -7},
{1, 7},
{5, -5},
{5, 5},
{7, -1},
{7, 1},
{-7, -3},
{-7, 3},
{-3, -7},
{-3, 7},
{3, -7},
{3, 7},
{7, -3},
{7, 3},
{-7, -5},
{-7, 5},
{-5, -7},
{-5, 7},
{5, -7},
{5, 7},
{7, -5},
{7, 5},
{-9, -1},
{-9, 1},
{-1, -9},
{-1, 9},
{1, -9},
{1, 9},
{9, -1},
{9, 1},
{-9, -3},
{-9, 3},
{-3, -9},
{-3, 9},
{3, -9},
{3, 9},
{9, -3},
{9, 3},
{-7, -7},
{-7, 7},
{7, -7},
{7, 7},
{-9, -5},
{-9, 5},
{-5, -9},
{-5, 9},
{5, -9},
{5, 9},
{9, -5},
{9, 5},
{-11, -1},
{-11, 1},
{-1, -11},
{-1, 11},
{1, -11},
{1, 11},
{11, -1},
{11, 1},
{-11, -3},
{-11, 3},
{-9, -7},
{-9, 7},
{-7, -9},
{-7, 9},
{-3, -11},
{-3, 11},
{3, -11},
{3, 11},
{7, -9},
{7, 9},
{9, -7},
{9, 7},
{11, -3},
{11, 3},
{-11, -5},
{-11, 5},
{-5, -11},
{-5, 11},
{5, -11},
{5, 11},
{11, -5},
{11, 5},
{-9, -9},
{-9, 9},
{9, -9},
{9, 9},
{-13, -1},
{-13, 1},
{-11, -7},
{-11, 7},
{-7, -11},
{-7, 11},
{-1, -13},
{-1, 13},
{1, -13},
{1, 13},
{7, -11},
{7, 11},
{11, -7},
{11, 7},
{13, -1},
{13, 1},
{-13, -3},
{-13, 3},
{-3, -13},
{-3, 13},
{3, -13},
{3, 13},
{13, -3},
{13, 3},
{-13, -5},
{-13, 5},
{-5, -13},
{-5, 13},
{5, -13},
{5, 13},
{13, -5},
{13, 5},
{-11, -9},
{-11, 9},
{-9, -11},
{-9, 11},
{9, -11},
{9, 11},
{11, -9},
{11, 9},
{-13, -7},
{-13, 7},
{-7, -13},
{-7, 13},
{7, -13},
{7, 13},
{13, -7},
{13, 7},
{-15, -1},
{-15, 1},
{-1, -15},
{-1, 15},
{1, -15},
{1, 15},
{15, -1},
{15, 1},
{-15, -3},
{-15, 3},
{-3, -15},
{-3, 15},
{3, -15},
{3, 15},
{15, -3},
{15, 3},
{-11, -11},
{-11, 11},
{11, -11},
{11, 11},
{-15, -5},
{-15, 5},
{-13, -9},
{-13, 9},
{-9, -13},
{-9, 13},
{-5, -15},
{-5, 15},
{5, -15},
{5, 15},
{9, -13},
{9, 13},
{13, -9},
{13, 9},
{15, -5},
{15, 5},
{-15, -7},
{-15, 7},
{-7, -15},
{-7, 15},
{7, -15},
{7, 15},
{15, -7},
{15, 7},
{-17, -1},
{-17, 1},
{-13, -11},
{-13, 11},
{-11, -13},
{-11, 13},
{-1, -17},
{-1, 17},
{1, -17},
{1, 17},
{11, -13},
{11, 13},
{13, -11},
{13, 11},
{17, -1},
{17, 1},
{-17, -3},
{-17, 3},
{-3, -17},
{-3, 17},
{3, -17},
{3, 17},
{17, -3},
{17, 3},
{-15, -9},
{-15, 9},
{-9, -15},
{-9, 15},
{9, -15},
{9, 15},
{15, -9},
{15, 9},
{-17, -5},
{-17, 5},
{-5, -17},
{-5, 17},
{5, -17},
{5, 17},
{17, -5},
{17, 5}

};


// from DVB S2X 8+16+20+20APSK constellation
static const float table_64APSK[64][2]=
{
  {  2.2*cos(PI*25/16), 2.2*sin(PI*25/16)},
{2.2*cos(PI*23/16), 2.2*sin(PI*23/16)},
{2.2*cos(PI*7/16), 2.2*sin(PI*7/16)},
{2.2*cos(PI*9/16), 2.2*sin(PI*9/16)},
{5.2*cos(PI*7/4 ), 5.2*sin(PI*7/4 )},
{5.2*cos(PI*5/4 ), 5.2*sin(PI*5/4 )},
{5.2*cos(PI*1/4 ), 5.2*sin(PI*1/4 )},
{5.2*cos(PI*3/4 ), 5.2*sin(PI*3/4 )},
{2.2*cos(PI*27/16 ),2.2*sin(PI*27/16 )},
{2.2*cos(PI*21/16 ), 2.2*sin(PI*21/16 )},
{2.2*cos(PI*5/16 ), 2.2*sin(PI*5/16 )},
{2.2*cos(PI*11/16 ), 2.2*sin(PI*11/16 )},
{3.6*cos(PI*7/4 ) , 3.6*sin(PI*7/4 )},
{3.6*cos(PI*5/4 ), 3.6*sin(PI*5/4 )},
{3.6*cos(PI*1/4 ), 3.6*sin(PI*1/4 )},
{3.6*cos(PI*3/4 ), 3.6*sin(PI*3/4 )},
{5.2*cos(PI*31/20 ), 5.2*sin(PI*31/20 )},
{5.2*cos(PI*29/20 ),5.2*sin(PI*29/20 )},
{5.2*cos(PI*9/20 ), 5.2*sin(PI*9/20 )},
{5.2*cos(PI*11/20 ), 5.2*sin(PI*11/20 )},
{5.2*cos(PI*33/20 ),5.2*sin(PI*33/20 )},
{5.2*cos(PI*27/20 ), 5.2*sin(PI*27/20 )},
{5.2*cos(PI*7/20 ),5.2*sin(PI*7/20 )},
{5.2*cos(PI*13/20 ), 5.2*sin(PI*13/20 )},
{3.6*cos(PI*31/20 ),3.6*sin(PI*31/20 )},
{3.6*cos(PI*29/20 ),3.6*sin(PI*29/20 )},
{3.6*cos(PI*9/20 ), 3.6*sin(PI*9/20 )},
{3.6*cos(PI*11/20 ), 3.6*sin(PI*11/20 )},
{3.6*cos(PI*33/20 ),  3.6*sin(PI*33/20 )},
{3.6*cos(PI*27/20 ),3.6*sin(PI*27/20 )},
{3.6*cos(PI*7/20 ),3.6*sin(PI*7/20 )},
{3.6*cos(PI*13/20 ), 3.6*sin(PI*13/20 )},
{cos(PI*13/8 ),sin(PI*13/8 )},
{cos(PI*11/8 ), sin(PI*11/8 )},
{cos(PI*3/8 ),sin(PI*3/8 )},
{cos(PI*5/8 ),sin(PI*5/8 )},
{5.2*cos(PI*37/20 ),5.2*sin(PI*37/20 )},
{5.2*cos(PI*23/20 ),  5.2*sin(PI*23/20 )},
{5.2*cos(PI*3/20 ) ,5.2*sin(PI*3/20 )},
{5.2*cos(PI*17/20 ),5.2*sin(PI*17/20 )},
{2.2*cos(PI*29/16 ), 2.2*sin(PI*29/16 )},
{2.2*cos(PI*19/16 ), 2.2*sin(PI*19/16 )},
{2.2*cos(PI*3/16 ), 2.2*sin(PI*3/16 )},
{2.2*cos(PI*13/16 ), 2.2*sin(PI*13/16 )},
{3.6*cos(PI*37/20 ), 3.6*sin(PI*37/20 )},
{3.6*cos(PI*23/20 ),  3.6*sin(PI*23/20 )},
{3.6*cos(PI*3/20 ), 3.6*sin(PI*3/20 )},
{3.6*cos(PI*17/20 ),3.6*sin(PI*17/20 )},
{cos(PI*15/8 ),sin(PI*15/8 )},
{cos(PI*9/8 ), sin(PI*9/8 )},
{cos(PI*1/8 ),sin(PI*1/8 )},
{cos(PI*7/8 ),sin(PI*7/8 )},
{5.2*cos(PI*39/20 ),5.2*sin(PI*39/20 )},
{5.2*cos(PI*21/20 ),5.2*sin(PI*21/20 )},
{5.2*cos(PI*1/20 ),5.2*sin(PI*1/20 )},
{5.2*cos(PI*19/20 ),5.2*sin(PI*19/20 )},
{2.2*cos(PI*31/16 ),2.2*sin(PI*31/16 )},
{2.2*cos(PI*17/16 ),2.2*sin(PI*17/16 )},
{2.2*cos(PI*1/16 ),2.2*sin(PI*1/16 )},
{2.2*cos(PI*15/16 ),2.2*sin(PI*15/16 )},
{3.6*cos(PI*39/20 ),3.6*sin(PI*39/20 )},
{3.6*cos(PI*21/20 ), 3.6*sin(PI*21/20 )},
{3.6*cos(PI*1/20 ),3.6*sin(PI*1/20 )},
{3.6*cos(PI*19/20 ),3.6*sin(PI*19/20 )}
};






#endif
